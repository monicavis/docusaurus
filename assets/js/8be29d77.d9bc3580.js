"use strict";(self.webpackChunkarchive_view=self.webpackChunkarchive_view||[]).push([[5525],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>d});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(r),h=a,d=c["".concat(s,".").concat(h)]||c[h]||m[h]||i;return r?n.createElement(d,o(o({ref:t},u),{},{components:r})):n.createElement(d,o({ref:t},u))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=r[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},35690:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=r(87462),a=(r(67294),r(3905));const i={},o="2.3 Installing the Archive Viewer Query Server",l={unversionedId:"Installation Manual/Installing_AV/2.3_Installing_AV_Query_Server/2.3_Installing_AV_Query_Server",id:"version-11.7.0.3/Installation Manual/Installing_AV/2.3_Installing_AV_Query_Server/2.3_Installing_AV_Query_Server",title:"2.3 Installing the Archive Viewer Query Server",description:"Prerequisite :Before you install the Query Server, you must ensure",source:"@site/versioned_docs/version-11.7.0.3/Installation Manual/2.Installing_AV/2.3_Installing_AV_Query_Server/2.3_Installing_AV_Query_Server.md",sourceDirName:"Installation Manual/2.Installing_AV/2.3_Installing_AV_Query_Server",slug:"/Installation Manual/Installing_AV/2.3_Installing_AV_Query_Server/",permalink:"/docusaurus/docs/Installation Manual/Installing_AV/2.3_Installing_AV_Query_Server/",draft:!1,tags:[],version:"11.7.0.3",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"2.2 Post-installation Steps",permalink:"/docusaurus/docs/Installation Manual/Installing_AV/2.2Post-installation_Steps/"},next:{title:"2.4 Installing the Archive Viewer Reporting Server",permalink:"/docusaurus/docs/Installation Manual/Installing_AV/2.4Installing_AV_Reporting_Server/"}},s={},p=[],u={toc:p},c="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(c,(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"23-installing-the-archive-viewer-query-server"},"2.3 Installing the Archive Viewer Query Server"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Prerequisite :"),"Before you install the Query Server, you must ensure\nthat the hardware and software requirements are met."),(0,a.kt)("p",null,"\ud83d\udc49 ",(0,a.kt)("a",{parentName:"p",href:"/docusaurus/docs/Installation%20Manual/Introduction_OAV/1.3Requirements_AV_Query_Server/"},"See Section 1.3 Hardware and Software Requirements for Archive Viewer Query Server for more details.")),(0,a.kt)("p",null,"Query Server is used to create a table for the Parquet files that are\ncreated by the Conversion Server. This helps users to connect via\nODBC/JDBC and query the data by using SQL."),(0,a.kt)("p",null,"Do the following to install the Archive Viewer Query Server:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Copy the software in a ",(0,a.kt)("strong",{parentName:"p"},"Linux")," platform.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Navigate to the ",(0,a.kt)("inlineCode",{parentName:"p"},"\u2026/installation/linux/queryserver_script/"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Run the command")," ",(0,a.kt)("inlineCode",{parentName:"p"},"python3 queryserverInstall.py")),(0,a.kt)("admonition",{parentName:"li",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"You should use the appropriate Python version that is, ",(0,a.kt)("strong",{parentName:"p"},"python3.9 queryserverInstall.py"))),(0,a.kt)("p",{parentName:"li"},"The ",(0,a.kt)("strong",{parentName:"p"},"queryserverInstall.py")," script validates for the following:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Validates the platform used."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Query server can be installed in two ways online/offline."),(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Online:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"When prompted, select default Yes to install it in online mode.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Specify the location where the query server needs to be installed."),(0,a.kt)("admonition",{parentName:"li",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"queryserver_script folder contains ",(0,a.kt)("strong",{parentName:"p"},"spark_link.json")," file with spark link, which can be upgraded or downgraded based on the version required."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"To start the query server after installation, navigate to: ",(0,a.kt)("strong",{parentName:"p"},"/queryserver_location /spark-3.4.0-bin-hadoop3/sbin")),(0,a.kt)("p",{parentName:"li"},"Run the below command:\n",(0,a.kt)("strong",{parentName:"p"},"./start-thriftserver.sh"))))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Offline:"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Download the tar file to a server with internet access by using the below link:\n\ud83d\udc49 ",(0,a.kt)("a",{parentName:"p",href:"https://apache.osuosl.org/spark/spark-3.4.0/spark-3.4.0.tgz"},"https://apache.osuosl.org/spark/spark-3.4.0/spark-3.4.0.tgz"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"copy the downloaded tar file to the server without internet access")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Specify the location of the Spark tar file.")))))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"A ",(0,a.kt)("strong",{parentName:"p"},"spark-defaults.conf")," file will be created in the specified location which will contain spark configurations."))),(0,a.kt)("p",null,"This downloads the query server installer packages from Website, extracts the files, and installs the Query Server."),(0,a.kt)("p",null,"You should have a shared path between Archive Viewer Conversion Server and Archive Viewer Query Server when these servers are installed on different platforms."),(0,a.kt)("p",null,"You can secure the query server by adding LDAP authentication, that is, by renaming the ",(0,a.kt)("strong",{parentName:"p"},"hive-site.xml_default")," to the ",(0,a.kt)("strong",{parentName:"p"},"hive-site.xml")," file in the $SPARK_HOME/conf folder."),(0,a.kt)("p",null,"Here is an ",(0,a.kt)("strong",{parentName:"p"},"example")," of the ",(0,a.kt)("inlineCode",{parentName:"p"},"hive-site.xml")," file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    <configuration>\n        <property>\n            <name>hive.server2.authentication</name>\n            <value>LDAP</value>\n            <description>\n                Expects one of [nosasl, none, ldap, kerberos, pam, custom].\n                Client authentication types.\n                NONE: no authentication check\n                LDAP: LDP/AD based authentication\n                KERBEROS: Kerberos/GSSAPI authentication\n                CUSTOM: Custom authentication provider\n                (Use with property hive.server2.custom.authentication.class)\n                PAM: Pluggable authentication module\n                NOSASL: Raw transport\n            </description>\n        </property>\n        <property>\n            <name>hive.server2.authentication.ldap.userDNPattern</name>\n            <value>udi=%s,ou=users,ou=system</value>\n            <description>\n                COLON-separated list of patterns to use to find DNs for user entities in this directory. Use %s where the actual group name is to be substituted for.\n                For example: CN=%s,CN=Groups,DC=subdomine,DC=domine,DC-com.\n            </description>\n        </property>\n        <property>\n            <name>hive.server2.authentication.ldap.groupDNPattern</name>\n            <value>uid=%s,ou=users,ou=system</value>\n            <description> COLON-separated list of patterns to use to find DNs for group entities in this directory. Use %s where the actual group name is to be substituted for. For example: CN=%s,CN=Groups,DC=subdomain,DC=domain,DC=com. </description>\n        </property>\n    </configuration>\n\n")),(0,a.kt)("p",null,"For more information, see the Data Access section at the following site:"),(0,a.kt)("p",null,"\ud83d\udc49 ",(0,a.kt)("a",{parentName:"p",href:"https://docs.cloudera.com/HDPDocuments/HDP2/HDP-2.6.1/bk_data-access/content/ch02s05s02.html"},"https://docs.cloudera.com/HDPDocuments/HDP2/HDP-2.6.1/bk_data-access/content/ch02s05s02.html")),(0,a.kt)("p",null,"Navigate to the directory where the application is installed and edit the properties.json file by changing query server auth_mechanism from ",(0,a.kt)("strong",{parentName:"p"},"PLAIN")," to ",(0,a.kt)("strong",{parentName:"p"},"LDAP")))}m.isMDXComponent=!0}}]);